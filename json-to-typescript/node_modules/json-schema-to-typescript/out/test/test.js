"use strict";
var index_1 = require('../src/index');
var chai_1 = require('chai');
var fs = require('fs');
var path = require('path');
var modules = new Map();
var dir = __dirname + '/cases';
fs.readdirSync(dir).forEach(function (moduleName) {
    if (!/^.*\.js$/.test(moduleName))
        return;
    var p = path.join(dir, moduleName);
    try {
        var module_1 = require(p);
        modules.set(moduleName, module_1);
    }
    catch (e) {
        console.error('Unable to load module', moduleName, e);
    }
});
modules.forEach(function (exports, name) {
    if (exports.configurations) {
        describe(name, function () {
            exports.configurations.forEach(function (cfg) {
                it(JSON.stringify(cfg.settings), function () {
                    if (cfg.error) {
                        chai_1.expect(function () { return index_1.compile(cfg.schema, name, cfg.settings); }).to.throw(cfg.error.type, cfg.error.message);
                    }
                    else {
                        chai_1.expect(index_1.compile(exports.schema, name, cfg.settings)).to.be.equal(cfg.types);
                    }
                });
            });
        });
    }
    else {
        describe(name, function () {
            it('default settings', function () {
                if (exports.error) {
                    chai_1.expect(function () { return index_1.compile(exports.schema, name, exports.settings); }).to.throw(exports.error.type, exports.error.message);
                }
                else {
                    chai_1.expect(index_1.compile(exports.schema, name, exports.settings)).to.be.equal(exports.types);
                }
            });
        });
    }
});
//# sourceMappingURL=test.js.map